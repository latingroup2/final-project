
<% if current_profesor == nil %>
  <div class="container">
    <div style="height: 100px;">
    </div>
    
    <div class="row">
      <div class="col-md-8 offset-md-2">
        <div class="card" style="height: 500px;">
          <div class="card-title">
          </div>
          
          <div class="card-body" align="center">
            <div style="height: 50px;">
            </div>
            
            <div>
              <i class="fas fa-calculator fa-10x"></i>
            </div>
            
            <div style="height: 100px;">
            </div>
            
            <div>
              <a href="/users/sign_in/" class="btn btn-primary btn-block" align="bottom">
                
                  Inicia sesión para empezar a ejercitar
              </a>
            </div>
            <div>
              <a href="/users/sign_up/" class="btn btn-warning btn-block" align="bottom">
                
                  ...O crea una cuenta nueva para empezar!
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
<% else %>
  <div class="container">
    <div style="height: 20px;">
    </div>
    
    <div>
      <a href="javascript:history.back()" class="btn btn-primary btn-block" > Volver a cursos </a>
    </div>
    
    <div style="height: 20px;">
    </div>
    
    
    <!--- puntajes distribucion --->
    <h4> Distribucion de niveles en el curso </h4>
    <div class="row">
          <!--- consolidado Enteros --->
          <div class="col-md-6">
            <div class="card border-warning mb-3">
              <h6 class="card-header text-white bg-warning mb-3"> <i class="far fa-list-alt" style="color:warning"></i> Enteros </h6>
              
              <div class="card-body" align="left" style="font-size:90%;">
                <table class="table">
                <tr>
                  <th>
                    Nivel
                  </th>
                  <th>
                    Distribución
                  </th>
              
                </tr>
                
                <tr>
                  <th>
                    Muy alto
                  </th>
                  <th>
                    <div> 
                      <% tot = @sala.users.count %>
                      <% cont = @sala.alumnos_en_rango(800,2000,1).to_f %>
                      <% now = 100 * cont/@sala.users.count %>
                      <% sty = "width:" + now.round(2).to_s + "%"  %>
                      
                        <div class="progress">
                          <div class="progress-bar bg-primary" role="progressbar" style="<%= sty %>;" aria-valuenow =<%= now %>  aria-valuemin=0 aria-valuemax="<%= tot %>"> 
                            <%= (100 * cont/@sala.users.count).round(1).to_s + "%, (" + cont.round(0).to_s + " alum)" %> 
                          </div>
                        </div>
                    </div>
                    
                  </th>
                </tr>
                  
                <tr>
                  <th>
                    Alto
                  </th>
                  <th>
                    <div> 
                      <% tot = @sala.users.count %>
                      <% cont = @sala.alumnos_en_rango(600,800,1).to_f %>
                      <% now = 100 * cont/@sala.users.count %>
                      <% sty = "width:" + now.round(2).to_s + "%"  %>
                      
                        <div class="progress">
                          <div class="progress-bar bg-success" role="progressbar" style="<%= sty %>;" aria-valuenow =<%= now %>  aria-valuemin=0 aria-valuemax="<%= tot %>"> 
                            <%= (100 * cont/@sala.users.count).round(1).to_s + "%, (" + cont.round(0).to_s + " alum)" %> 
                          </div>
                        </div>
                    </div>
                  </th>
                </tr>
                
                <tr>
                  <th>
                    Medio
                  </th>
                  <th>
                    <div> 
                      <% tot = @sala.users.count %>
                      <% cont = @sala.alumnos_en_rango(400,600,1).to_f %>
                      <% now = 100 * cont/@sala.users.count %>
                      <% sty = "width:" + now.round(2).to_s + "%"  %>
                      
                        <div class="progress">
                          <div class="progress-bar bg-info" role="progressbar" style="<%= sty %>;" aria-valuenow =<%= now %>  aria-valuemin=0 aria-valuemax="<%= tot %>"> 
                            <%= (100 * cont/@sala.users.count).round(1).to_s + "%, (" + cont.round(0).to_s + " alum)" %> 
                          </div>
                        </div>
                    </div>
                  </th>
                </tr>
                
                <tr>
                  <th>
                    Bajo
                  </th>
                  <th>
                    <div> 
                      <% tot = @sala.users.count %>
                      <% cont = @sala.alumnos_en_rango(200,400,1).to_f %>
                      <% now = 100 * cont/@sala.users.count %>
                      <% sty = "width:" + now.round(2).to_s + "%"  %>
                      
                        <div class="progress">
                          <div class="progress-bar bg-warning" role="progressbar" style="<%= sty %>;" aria-valuenow =<%= now %>  aria-valuemin=0 aria-valuemax="<%= tot %>"> 
                            <%= (100 * cont/@sala.users.count).round(1).to_s + "%, (" + cont.round(0).to_s + " alum)" %> 
                          </div>
                        </div>
                    </div>
                  </th>
                </tr>
                
                <tr>
                  <th>
                    Muy bajo
                  </th>
                  <th>
                    <div> 
                      <% tot = @sala.users.count %>
                      <% cont = @sala.alumnos_en_rango(0,200,1).to_f %>
                      <% now = 100 * cont/@sala.users.count %>
                      <% sty = "width:" + now.round(2).to_s + "%"  %>
                      
                        <div class="progress">
                          <div class="progress-bar bg-danger" role="progressbar" style="<%= sty %>;" aria-valuenow =<%= now %>  aria-valuemin=0 aria-valuemax="<%= tot %>"> 
                            <%= (100 * cont/@sala.users.count).round(1).to_s + "%, (" + cont.round(0).to_s + " alum)" %> 
                          </div>
                        </div>
                    </div>
                  </th>
                </tr>
                </table>  
                
              </div>
            </div>
          </div>
          
          <!--- consolidado Racionales --->
          <div class="col-md-6">
            <div class="card border-warning mb-3">
              <h6 class="card-header text-white bg-warning mb-3"> <i class="far fa-list-alt fa-1x" style="color:warning"></i> Racionales </h6>
              
              <div class="card-body" align="left" style="font-size:90%;">
                
                <table class="table">
                <tr>
                  <th>
                    Nivel
                  </th>
                  <th>
                    Distribución
                  </th>
                </tr>
                
                <tr>
                  <th>
                    Muy alto
                  </th>
                  <th>
                    <div> 
                      <% tot = @sala.users.count %>
                      <% cont = @sala.alumnos_en_rango(800,2000,2).to_f %>
                      <% now = 100 * cont/@sala.users.count %>
                      <% sty = "width:" + now.round(2).to_s + "%"  %>
                      
                        <div class="progress">
                          <div class="progress-bar bg-primary" role="progressbar" style="<%= sty %>;" aria-valuenow =<%= now %>  aria-valuemin=0 aria-valuemax="<%= tot %>"> 
                            <%= (100 * cont/@sala.users.count).round(1).to_s + "%, (" + cont.round(0).to_s + " alum)" %> 
                          </div>
                        </div>
                    </div>
                    
                  </th>
                </tr>
                  
                <tr>
                  <th>
                    Alto
                  </th>
                  <th>
                    <div> 
                      <% tot = @sala.users.count %>
                      <% cont = @sala.alumnos_en_rango(600,800,2).to_f %>
                      <% now = 100 * cont/@sala.users.count %>
                      <% sty = "width:" + now.round(2).to_s + "%"  %>
                      
                        <div class="progress">
                          <div class="progress-bar bg-success" role="progressbar" style="<%= sty %>;" aria-valuenow =<%= now %>  aria-valuemin=0 aria-valuemax="<%= tot %>"> 
                            <%= (100 * cont/@sala.users.count).round(1).to_s + "%, (" + cont.round(0).to_s + " alum)" %> 
                          </div>
                        </div>
                    </div>
                  </th>
                </tr>
                
                <tr>
                  <th>
                    Medio
                  </th>
                  <th>
                    <div> 
                      <% tot = @sala.users.count %>
                      <% cont = @sala.alumnos_en_rango(400,600,2).to_f %>
                      <% now = 100 * cont/@sala.users.count %>
                      <% sty = "width:" + now.round(2).to_s + "%"  %>
                      
                        <div class="progress">
                          <div class="progress-bar bg-info" role="progressbar" style="<%= sty %>;" aria-valuenow =<%= now %>  aria-valuemin=0 aria-valuemax="<%= tot %>"> 
                            <%= (100 * cont/@sala.users.count).round(1).to_s + "%, (" + cont.round(0).to_s + " alum)" %> 
                          </div>
                        </div>
                    </div>
                  </th>
                </tr>
                
                <tr>
                  <th>
                    Bajo
                  </th>
                  <th>
                    <div> 
                      <% tot = @sala.users.count %>
                      <% cont = @sala.alumnos_en_rango(200,400,2).to_f %>
                      <% now = 100 * cont/@sala.users.count %>
                      <% sty = "width:" + now.round(2).to_s + "%"  %>
                      
                        <div class="progress">
                          <div class="progress-bar bg-warning" role="progressbar" style="<%= sty %>;" aria-valuenow =<%= now %>  aria-valuemin=0 aria-valuemax="<%= tot %>"> 
                            <%= (100 * cont/@sala.users.count).round(1).to_s + "%, (" + cont.round(0).to_s + " alum)" %> 
                          </div>
                        </div>
                    </div>
                  </th>
                </tr>
                
                <tr>
                  <th>
                    Muy bajo
                  </th>
                  <th>
                    <div> 
                      <% tot = @sala.users.count %>
                      <% cont = @sala.alumnos_en_rango(0,200,2).to_f %>
                      <% now = 100 * cont/@sala.users.count %>
                      <% sty = "width:" + now.round(2).to_s + "%"  %>
                      
                        <div class="progress">
                          <div class="progress-bar bg-danger" role="progressbar" style="<%= sty %>;" aria-valuenow =<%= now %>  aria-valuemin=0 aria-valuemax="<%= tot %>"> 
                            <%= (100 * cont/@sala.users.count).round(1).to_s + "%, (" + cont.round(0).to_s + " alum)" %> 
                          </div>
                        </div>
                    </div>
                  </th>
                </tr>
                </table>
                
              </div>
            </div>
          </div>
        
    </div>
    
    <!--- Lista de curso --->
    <h4> Lista del curso </h4>
    <div class="row">
      <div class="col-md-12">
          <div class="card border-warning mb-3">
            <h6 class="card-header text-white bg-warning mb-3"> <i class="fas fa-users" style="color:warning"></i> Alumnos </h6>
            
            <div class="card-body" align="left" style="font-size:90%;">
              <table class="table">
                <tr>
                  <th>
                    Alumno
                  </th>
                  <th>
                    #ejercicios resueltos (% buenas)
                  </th>
                  <th>
                    Nivel Enteros
                  </th>
                  <th>
                    Nivel Racionales
                  </th>
                  <th>
                    
                  </th>
                </tr>
                
                <% @sala.users.each do |alumno| %>
                  <tr>
                    <th>
                      <a href = "/nivels_prof/<%= alumno.id %>"> <%= alumno.last_name.to_s + " " + alumno.first_name.to_s %> </a>
                    </th>
                    <th>
                      <% tratados= Try.where("user_id==?",alumno.id).count %>
                      <% if tratados == 0 %>
                        <% tratados =1 %>
                      <% end %>
                      <% buenos = Try.where("user_id==? and correct ==?",alumno.id, true).count %>
                      <p> <%= tratados.to_s + " (" + (100*buenos/tratados).to_s + "%)"  %> </p>
                    </th>
                    <th>
                      <% if alumno.nivels.last != nil %>
                        <%= alumno.nivels.last.puntajes.where("categoria_id == ?",1).last.score %>
                      <% end %>  
                    </th>
                    <th>
                      <% if alumno.nivels.last != nil %>
                        <%= alumno.nivels.last.puntajes.where("categoria_id == ?",2).last.score %>
                      <% end %> 
                    </th>
                    <th>
                      
                    </th>
                  </tr>
                <% end %>
                
              </table>
              
            </div>
          </div>
        </div>
    </div>
  </div>
  
<% end %>